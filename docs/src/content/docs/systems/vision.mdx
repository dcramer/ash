---
title: Vision
description: Inbound image understanding and context injection
sidebar:
  order: 6
---

Ash handles inbound images through a dedicated vision integration hook.

## How It Works

1. Provider (for example Telegram) downloads image bytes into `IncomingMessage.images`.
2. `ImageIntegration.preprocess_incoming_message` runs before normal session/agent flow.
3. The image provider (currently OpenAI) analyzes the image.
4. Ash injects a structured `[IMAGE_CONTEXT]` block into the user message text.
5. The rest of the pipeline stays text-first and unchanged.

## Minimal Config

```toml
[image]
enabled = true
provider = "openai"
```

You also need an OpenAI API key:

- `[openai].api_key` in config, or
- `OPENAI_API_KEY` in environment.

## Recommended Config

```toml
[image]
enabled = true
provider = "openai"
max_images_per_message = 1
max_image_bytes = 8000000
request_timeout_seconds = 12.0
include_ocr_text = true
inject_position = "prepend"
no_caption_auto_respond = true
```

## Operational Notes

- If vision is enabled but credentials are missing, image preprocessing is skipped safely.
- If image data is unusable (missing/oversized), Ash falls back to a clarifying text prompt.
- Run `ash doctor` to catch common config gaps.
